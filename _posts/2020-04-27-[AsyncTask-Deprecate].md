---
layout: post
title: AsyncTask Deprecate 이유
description: AsyncTask Thread Service
date:   2020-04-27
categories: android
---
### [AsyncTask Deprecate 이유]

AsyncTask의 주요 목표는 나중에 UI스레드와 상호 작용할 수 있는 백그라운드에서 스레드를 쉽게 실행할 수 있도록 하는 것이다. 따라서 가장 일반적인 사용사례는 AsyncTask가 완료되면 UI의 일부를 업데이트하는 시간이 많이 걸리는 작업을 수행하는 것이다.(AsyncTask.onPostExecute() 에서)

이것은 화면을 회전시킬 때까지 훌륭하게 작동한다. 앱이 회전하면 전체 액티비티가 파괴되고 다시 생성된다.

액티비티가 다시시작되면  액티비티에 대한 AsyncTask의 참조가 유효하지 않으므로 onPostExecute()는 새 액티비티에 영향을 미치지 않는다. 

AsyncTask를 액티비티의 내부 클래스로 사용하여 현재 액티비티를 암시적으로 참조하는 경우에 이런 혼동이 발생할 수 있다.

따라서 AsyncTask를 생성 한 액티비티가 죽었기 때문에 AsyncTask도 죽었다고 생각하는 건 오해다.

전체 앱이 종료하더라도 계속 실행된다. AsyncTask가 일찍 finish되는 유일한 방법은 AsyncTask.cancel()을 통해 취소하는 것이다.

또한

많은 응용 프로그램이 수행해야 할 한 가지는 원격 서버에서 정보를 가져 오는 것이다. 네트워크 요청은 시간이 걸릴 수 있으므로 일반적으로 응용 프로그램이 중단되지 않도록 비동기 적으로 요청하는 것이 중요하다. 작업이 완료되면 UI를 업데이트 할 수 있다. 그러나 네트워크 요청이 완료 될 때 UI의 관련 부분이 더 이상 존재하지 않아 충돌이나 다른 버그가 발생할 수 있다. 

-> AsyncTask는 전체 프로세스를 단순화하지만 Android의 응용 프로그램 수명주기를 존중하지 않는다. 



**1. AsyncTask들의 취소를 직접 관리해야 한다. 그렇지 않으면 불필요한 백그라운드 작업으로 앱이 다운되거나 메모리 누수가 발생할 위험이 있다.** 

**2. UI변경 후 AsyncTask 마무리에 대해 기본적으로 보호되지 않는다.**



> 참고

***Thread** : 작업을 동시에 실행할 수 있는 클래스이다. Thread 를 상속받거나, Runnable 을 구현하여 사용할 수 있다. 쓰레드는 일반적으로 긴 작업을 수행하는 데 사용한다. 쓰레드는 수동으로 관리해야 하기 때문에 관리가 어렵고 코드를 읽기 어려워 질 수 있다는 단점이 있다.*

***Service** : 서비스는 백그라운드에서 실행시간이 긴 작업을 수행하며, 사용자 인터페이스를 제공하지 않는 어플리케이션 구성요소이다. UI 가 없는 작업이긴 하지만, 작업시간이 너무 길지 않아야 하며, 긴 작업이 필요하다면 서비스 내에서 스레드를 사용해야 한다.*

***AsyncTask** : 비동기 작업을 백그라운드 스레드에서 실행하고 결과가 UI 스레드에 게시되게 하는 데 사용되는 클래스이다. 스레드나 핸들러를 조작하지 않고도 UI 스레드를 적절하고 쉽게 사용할 수 있다. 메인 스레드와 통신해야 하는 작업에 사용하며, 핸들러와 달리 무조건 메인 스레드에서 생성하고 실행해야한다.*



